<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>UTA Lost & Found - Report Lost Item</title>
    <meta name="description" content="Report a lost item at UTA">
    
    <!-- Favicon -->
    <link rel="icon" type="image/svg+xml" href="data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMzIiIGhlaWdodD0iMzIiIHZpZXdCb3g9IjAgMCAzMiAzMiIgZmlsbD0ibm9uZSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj4KPHJlY3Qgd2lkdGg9IjMyIiBoZWlnaHQ9IjMyIiByeD0iNiIgZmlsbD0iIzRGNjQ2RTUiLz4KPHRleHQgeD0iMTYiIHk9IjIwIiBmb250LWZhbWlseT0iQXJpYWwiIGZvbnQtc2l6ZT0iMTIiIGZvbnQtd2VpZ2h0PSJib2xkIiBmaWxsPSJ3aGl0ZSIgdGV4dC1hbmNob3I9Im1pZGRsZSI+TEY8L3RleHQ+Cjwvc3ZnPgo=">
    
    <!-- Stylesheets -->
    <link rel="stylesheet" href="styles.css">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" rel="stylesheet">
    <link href="https://use.fontawesome.com/releases/v6.4.0/css/all.css" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    
    <style>
        .lost-container {
            min-height: 100vh;
            background: linear-gradient(135deg, #4f46e5 0%, #1d4ed8 100%);
            padding: 20px;
        }
        
        .lost-card {
            background: white;
            border-radius: 16px;
            box-shadow: 0 20px 25px -5px rgba(0, 0, 0, 0.1);
            padding: 40px;
            max-width: 800px;
            margin: 0 auto;
        }
        
        .lost-header {
            text-align: center;
            margin-bottom: 30px;
        }
        
        .lost-header h1 {
            color: #374151;
            font-size: 1.875rem;
            font-weight: 700;
            margin-bottom: 8px;
        }
        
        .lost-header p {
            color: #6b7280;
            font-size: 0.875rem;
        }
        
        .form-steps {
            display: flex;
            justify-content: center;
            margin-bottom: 30px;
        }
        
        .step {
            display: flex;
            align-items: center;
            margin: 0 10px;
        }
        
        .step-number {
            width: 30px;
            height: 30px;
            border-radius: 50%;
            background: #e5e7eb;
            color: #6b7280;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: 600;
            margin-right: 8px;
        }
        
        .step.active .step-number {
            background: #4f46e5;
            color: white;
        }
        
        .step.completed .step-number {
            background: #10b981;
            color: white;
        }
        
        .lost-form {
            display: flex;
            flex-direction: column;
            gap: 20px;
        }
        
        .form-group {
            display: flex;
            flex-direction: column;
            gap: 8px;
        }
        
        .form-label {
            font-weight: 500;
            color: #374151;
            font-size: 0.875rem;
        }
        
        .form-input, .form-textarea, .form-select {
            padding: 12px 16px;
            border: 2px solid #e5e7eb;
            border-radius: 8px;
            font-size: 1rem;
            transition: all 0.2s ease;
        }
        
        .form-input:focus, .form-textarea:focus, .form-select:focus {
            outline: none;
            border-color: #4f46e5;
            box-shadow: 0 0 0 3px rgba(79, 70, 229, 0.1);
        }
        
        .form-textarea {
            min-height: 100px;
            resize: vertical;
        }
        
        .btn-primary {
            background: #4f46e5;
            color: white;
            border: none;
            padding: 12px 24px;
            border-radius: 8px;
            font-size: 1rem;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.2s ease;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 8px;
        }
        
        .btn-primary:hover {
            background: #3730a3;
        }
        
        .btn-primary:disabled {
            background: #9ca3af;
            cursor: not-allowed;
        }
        
        .btn-secondary {
            background: #6b7280;
            color: white;
            border: none;
            padding: 12px 24px;
            border-radius: 8px;
            font-size: 1rem;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.2s ease;
        }
        
        .btn-secondary:hover {
            background: #4b5563;
        }
        
        .form-actions {
            display: flex;
            gap: 12px;
            justify-content: space-between;
            margin-top: 30px;
        }
        
        .error-message {
            background: #fee2e2;
            color: #991b1b;
            padding: 12px;
            border-radius: 8px;
            font-size: 0.875rem;
            display: none;
        }
        
        .success-message {
            background: #d1fae5;
            color: #065f46;
            padding: 12px;
            border-radius: 8px;
            font-size: 0.875rem;
            display: none;
        }
        
        .back-link {
            position: absolute;
            top: 20px;
            left: 20px;
            color: white;
            text-decoration: none;
            display: flex;
            align-items: center;
            gap: 8px;
            font-weight: 500;
        }
        
        .back-link:hover {
            text-decoration: underline;
        }
        
        .uta-badge {
            background: #f59e0b;
            color: white;
            padding: 4px 12px;
            border-radius: 20px;
            font-size: 0.75rem;
            font-weight: 600;
            text-transform: uppercase;
            display: inline-block;
            margin-bottom: 16px;
        }
        
        .image-upload {
            border: 2px dashed #d1d5db;
            border-radius: 8px;
            padding: 20px;
            text-align: center;
            cursor: pointer;
            transition: all 0.2s ease;
        }
        
        .image-upload:hover {
            border-color: #4f46e5;
            background: #f8fafc;
        }
        
        .image-upload.dragover {
            border-color: #4f46e5;
            background: #eef2ff;
        }
        
        .image-preview {
            display: flex;
            gap: 10px;
            margin-top: 10px;
            flex-wrap: wrap;
        }
        
        .image-preview-item {
            position: relative;
            width: 100px;
            height: 100px;
            border-radius: 8px;
            overflow: hidden;
        }
        
        .image-preview-item img {
            width: 100%;
            height: 100%;
            object-fit: cover;
        }
        
        .image-preview-item .remove-btn {
            position: absolute;
            top: 5px;
            right: 5px;
            background: rgba(0, 0, 0, 0.7);
            color: white;
            border: none;
            border-radius: 50%;
            width: 20px;
            height: 20px;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
        }
    </style>
</head>
<body>
    <a href="index.html" class="back-link">
        <i class="fas fa-arrow-left"></i>
        Back to Home
    </a>
    
    <div class="lost-container">
        <div class="lost-card">
            <div class="lost-header">
                <div class="uta-badge">UTA Students & Staff Only</div>
                <h1>Report Lost Item</h1>
                <p>Help us help you find your lost item</p>
            </div>
            
            <div class="form-steps">
                <div class="step active" data-step="1">
                    <div class="step-number">1</div>
                    <span>Basic Info</span>
                </div>
                <div class="step" data-step="2">
                    <div class="step-number">2</div>
                    <span>Location & Time</span>
                </div>
                <div class="step" data-step="3">
                    <div class="step-number">3</div>
                    <span>Images & Details</span>
                </div>
                <div class="step" data-step="4">
                    <div class="step-number">4</div>
                    <span>Contact & Submit</span>
                </div>
            </div>
            
            <div class="error-message" id="errorMessage"></div>
            <div class="success-message" id="successMessage"></div>
            
            <form class="lost-form" id="lostForm">
                <!-- Step 1: Basic Information -->
                <div class="form-step" id="step1">
                    <div class="form-group">
                        <label for="title" class="form-label">Item Title *</label>
                        <input type="text" id="title" name="title" class="form-input" 
                               placeholder="e.g., iPhone 13 Pro Max" required>
                    </div>
                    
                    <div class="form-group">
                        <label for="description" class="form-label">Description *</label>
                        <textarea id="description" name="description" class="form-textarea" 
                                  placeholder="Describe your lost item in detail..." required></textarea>
                    </div>
                    
                    <div class="form-group">
                        <label for="category" class="form-label">Category *</label>
                        <select id="category" name="category" class="form-select" required>
                            <option value="">Select a category</option>
                            <option value="Electronics">Electronics</option>
                            <option value="Clothing & Accessories">Clothing & Accessories</option>
                            <option value="Books & Study Materials">Books & Study Materials</option>
                            <option value="Personal Items">Personal Items</option>
                            <option value="Keys & ID Cards">Keys & ID Cards</option>
                            <option value="Bags & Backpacks">Bags & Backpacks</option>
                            <option value="Sports Equipment">Sports Equipment</option>
                            <option value="Other">Other</option>
                        </select>
                    </div>
                </div>
                
                <!-- Step 2: Location & Time -->
                <div class="form-step" id="step2" style="display: none;">
                    <div class="form-group">
                        <label for="location" class="form-label">Where did you lose it? *</label>
                        <div style="display: flex; gap: 10px; align-items: center;">
                            <input type="text" id="location" name="location" class="form-input" 
                                   placeholder="e.g., Library Building, Room 201" required style="flex: 1;">
                            <button type="button" id="getLocationBtn" class="btn-secondary" 
                                    style="padding: 12px; min-width: auto;" title="Use current location">
                                <i class="fas fa-map-marker-alt"></i>
                            </button>
                        </div>
                    </div>
                    
                    <div class="form-group">
                        <label for="dateLost" class="form-label">Date Lost *</label>
                        <input type="date" id="dateLost" name="dateLost" class="form-input" required>
                    </div>
                    
                    <div class="form-group">
                        <label for="timeLost" class="form-label">Approximate Time Lost *</label>
                        <input type="time" id="timeLost" name="timeLost" class="form-input" required>
                    </div>
                </div>
                
                <!-- Step 3: Images & Details -->
                <div class="form-step" id="step3" style="display: none;">
                    <div class="form-group">
                        <label class="form-label">Upload Photos (Optional)</label>
                        <div style="display: flex; gap: 10px; margin-bottom: 10px;">
                            <div class="image-upload" id="imageUpload" style="flex: 1;">
                                <i class="fas fa-cloud-upload-alt" style="font-size: 2rem; color: #6b7280; margin-bottom: 10px;"></i>
                                <p>Click to upload or drag and drop images here</p>
                                <p style="font-size: 0.875rem; color: #6b7280;">PNG, JPG up to 2MB each (max 5 images)</p>
                            </div>
                            <button type="button" id="takePhotoBtn" class="btn-secondary" 
                                    style="padding: 20px; min-width: auto; display: flex; flex-direction: column; align-items: center; gap: 8px;" 
                                    title="Take photo with camera">
                                <i class="fas fa-camera" style="font-size: 1.5rem;"></i>
                                <span style="font-size: 0.875rem;">Camera</span>
                            </button>
                        </div>
                        <input type="file" id="imageInput" multiple accept="image/*" style="display: none;">
                        <div class="image-preview" id="imagePreview"></div>
                    </div>
                    
                    <div class="form-group">
                        <label for="additionalDetails" class="form-label">Additional Details</label>
                        <textarea id="additionalDetails" name="additionalDetails" class="form-textarea" 
                                  placeholder="Any additional information that might help identify your item..."></textarea>
                    </div>
                </div>
                
                <!-- Step 4: Contact & Submit -->
                <div class="form-step" id="step4" style="display: none;">
                    <div class="form-group">
                        <label for="contactInfo" class="form-label">Contact Information *</label>
                        <input type="text" id="contactInfo" name="contactInfo" class="form-input" 
                               placeholder="Phone number or email" required>
                    </div>
                    
                    <div class="form-group">
                        <label for="preferredContact" class="form-label">Preferred Contact Method</label>
                        <select id="preferredContact" name="preferredContact" class="form-select">
                            <option value="email">Email</option>
                            <option value="phone">Phone</option>
                            <option value="both">Both</option>
                        </select>
                    </div>
                    
                    <div class="form-group">
                        <label class="form-label">
                            <input type="checkbox" id="termsAccepted" name="termsAccepted" required>
                            I agree to the <a href="#" target="_blank">Terms of Service</a> and <a href="#" target="_blank">Privacy Policy</a>
                        </label>
                    </div>
                </div>
                
                <div class="form-actions">
                    <button type="button" class="btn-secondary" id="prevBtn" style="display: none;">Previous</button>
                    <button type="button" class="btn-primary" id="nextBtn">Next</button>
                    <button type="submit" class="btn-primary" id="submitBtn" style="display: none;">
                        <i class="fas fa-paper-plane"></i>
                        Submit Report
                    </button>
                </div>
            </form>
        </div>
    </div>
    
    <!-- Firebase SDK -->
    <script type="module" src="https://www.gstatic.com/firebasejs/10.7.1/firebase-app.js"></script>
    <script type="module" src="https://www.gstatic.com/firebasejs/10.7.1/firebase-auth.js"></script>
    <script type="module" src="https://www.gstatic.com/firebasejs/10.7.1/firebase-firestore.js"></script>
    <script type="module" src="https://www.gstatic.com/firebasejs/10.7.1/firebase-storage.js"></script>
    
    <!-- Environment Variables (injected at build time) -->
    <script src="js/env.js"></script>
    
    <!-- Scripts -->
    <script type="module" src="js/firebase-config.js"></script>
    <script type="module" src="js/auth.js"></script>
    <script type="module" src="js/script.js"></script>
    
    <script>
        // Lost item form functionality
        let currentStep = 1;
        const totalSteps = 4;
        const uploadedImages = [];
        
        // Step navigation
        document.getElementById('nextBtn').addEventListener('click', () => {
            if (validateCurrentStep()) {
                if (currentStep < totalSteps) {
                    currentStep++;
                    updateStepDisplay();
                }
            }
        });
        
        document.getElementById('prevBtn').addEventListener('click', () => {
            if (currentStep > 1) {
                currentStep--;
                updateStepDisplay();
            }
        });
        
        function updateStepDisplay() {
            // Hide all steps
            for (let i = 1; i <= totalSteps; i++) {
                document.getElementById(`step${i}`).style.display = 'none';
                document.querySelector(`[data-step="${i}"]`).classList.remove('active', 'completed');
            }
            
            // Show current step
            document.getElementById(`step${currentStep}`).style.display = 'block';
            document.querySelector(`[data-step="${currentStep}"]`).classList.add('active');
            
            // Mark previous steps as completed
            for (let i = 1; i < currentStep; i++) {
                document.querySelector(`[data-step="${i}"]`).classList.add('completed');
            }
            
            // Update buttons
            document.getElementById('prevBtn').style.display = currentStep > 1 ? 'block' : 'none';
            document.getElementById('nextBtn').style.display = currentStep < totalSteps ? 'block' : 'none';
            document.getElementById('submitBtn').style.display = currentStep === totalSteps ? 'block' : 'none';
        }
        
        function validateCurrentStep() {
            const currentStepElement = document.getElementById(`step${currentStep}`);
            const requiredFields = currentStepElement.querySelectorAll('[required]');
            
            for (let field of requiredFields) {
                if (!field.value.trim()) {
                    showError(`Please fill in the ${field.previousElementSibling.textContent} field.`);
                    field.focus();
                    return false;
                }
            }
            
            return true;
        }
        
        // Image upload functionality
        document.getElementById('imageUpload').addEventListener('click', () => {
            document.getElementById('imageInput').click();
        });
        
        document.getElementById('imageInput').addEventListener('change', handleImageUpload);
        
        function handleImageUpload(event) {
            const files = Array.from(event.target.files);
            
            files.forEach(file => {
                if (file.size > 2 * 1024 * 1024) {
                    showError('Image size must be less than 2MB');
                    return;
                }
                
                if (uploadedImages.length >= 5) {
                    showError('Maximum 5 images allowed');
                    return;
                }
                
                const reader = new FileReader();
                reader.onload = (e) => {
                    uploadedImages.push({
                        file: file,
                        dataUrl: e.target.result
                    });
                    updateImagePreview();
                };
                reader.readAsDataURL(file);
            });
        }
        
        function updateImagePreview() {
            const preview = document.getElementById('imagePreview');
            preview.innerHTML = '';
            
            uploadedImages.forEach((image, index) => {
                const item = document.createElement('div');
                item.className = 'image-preview-item';
                item.innerHTML = `
                    <img src="${image.dataUrl}" alt="Preview">
                    <button type="button" class="remove-btn" onclick="removeImage(${index})">
                        <i class="fas fa-times"></i>
                    </button>
                `;
                preview.appendChild(item);
            });
        }
        
        function removeImage(index) {
            uploadedImages.splice(index, 1);
            updateImagePreview();
        }
        
        // Form submission
        document.getElementById('lostForm').addEventListener('submit', async (e) => {
            e.preventDefault();
            
            if (!validateCurrentStep()) {
                return;
            }
            
            const formData = new FormData(e.target);
            const lostItemData = {
                title: formData.get('title'),
                description: formData.get('description'),
                category: formData.get('category'),
                location: formData.get('location'),
                dateLost: formData.get('dateLost'),
                timeLost: formData.get('timeLost'),
                contactInfo: formData.get('contactInfo'),
                preferredContact: formData.get('preferredContact'),
                additionalDetails: formData.get('additionalDetails'),
                images: uploadedImages
            };
            
            try {
                // Submit lost item (this would integrate with your existing script.js)
                showSuccess('Lost item reported successfully! You will receive an email confirmation shortly.');
                e.target.reset();
                uploadedImages.length = 0;
                updateImagePreview();
                currentStep = 1;
                updateStepDisplay();
            } catch (error) {
                showError('Failed to submit lost item. Please try again.');
                console.error('Submission error:', error);
            }
        });
        
        function showError(message) {
            const errorDiv = document.getElementById('errorMessage');
            errorDiv.textContent = message;
            errorDiv.style.display = 'block';
            setTimeout(() => {
                errorDiv.style.display = 'none';
            }, 5000);
        }
        
        function showSuccess(message) {
            const successDiv = document.getElementById('successMessage');
            successDiv.textContent = message;
            successDiv.style.display = 'block';
            setTimeout(() => {
                successDiv.style.display = 'none';
            }, 5000);
        }
        
        // Set default date to today
        document.getElementById('dateLost').value = new Date().toISOString().split('T')[0];
    </script>
</body>
</html>
